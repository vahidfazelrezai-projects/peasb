{% extends "base.html" %}

{% block body %}
  {% include "navbar.html" %}
{% endblock %}

{% block content %}
  <h1>New Questions</h1>
  <form method="post" action="" class="form-inline" style="padding-bottom: 10px">{% csrf_token %}
    <div class="form-group">
      {{ form.subject.label_tag }} &nbsp;
      {{ form.subject }}
    </div>
  </form>
  <table id="q_list" style="table-layout: fixed; margin-left: 25px;">
    <col width="150px" />
    <col width="100px" />
    <col width="70px" />
    <col width="750px" />
    <tr>
      <th>Question ID</th>
      <th>Difficulty</th>
      <th>Type</th>
      <th>Question</th>
    </tr>
    {% for question in questions %}
      <tr class="{{question.subject}}">
        <td valign="top">
          {% if user.is_staff or user == question.author %}
            <a href="/qdb/edit_question/{{ question.id }}">{{ question.id }}</a>
          {% else %}
            {{ question.id }}
          {% endif %}
        </td>
        <td valign="top">{{ question.get_difficulty_display }}</td>
        <td valign="top">{{ question.question_type }}</td>
        <td style="padding-bottom: 10px;" valign="top">
          {{ question.subject }} <i>{{ question.question_format }}</i>
          <div style="display: inline; white-space: pre-wrap;">{{ question.question }}</div> <span style="float: right; font-size: 0.8em;">Written by {{ question.author.first_name }} {{ question.author.last_name }}.</span> </td>
      </tr>
    {% endfor %}
  </table>
  <script>
    function filter() {
      var sel = $("#id_subject")[0];
      var target = sel.options[sel.selectedIndex].text;
      var t = $("#q_list")[0];

      for (var i = 1; i < t.rows.length; i++) {
        if (t.rows[i].className === target || target === "---------") t.rows[i].style.display="table-row";
        else t.rows[i].style.display="none";
      }
    }
    window.onload = filter();
  </script>
{% endblock %}
